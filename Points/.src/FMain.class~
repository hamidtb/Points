' Gambas class file

Function CreateDatabase()
    Dim ObjConnect As New Connection
    Dim TBL As Table
    
        With ObjConnect
            .Type = "sqlite"
            .Host = User.Home & "/.Points/DB"
        End With
        
        If Not Exist(User.Home & "/.Points") Then
            
            Mkdir User.Home & "/.Points"
            
        Endif
        
        If Not Exist(User.Home & "/.Points/DB") Then
            
            Mkdir User.Home & "/.Points/DB"
            
        Endif
        
        ObjConnect.Open()
        ObjConnect.Databases.Add("Points")
        'ObjConnect.Exec("CREATE DATABASE Points")
        ObjConnect.Close()
        
        ObjConnect.Name = "Points"
        ObjConnect.Open()
        
        ObjConnect.Exec("Create TABLE catalogs( 'id' INTEGER Not Null, 'catalogname' TEXT Not Null)")
        ObjConnect.Exec("Create TABLE groups('id' INTEGER, 'catalogs_id' INTEGER, 'groupname' TEXT)")
        ObjConnect.Exec("Create TABLE 'subgroups'('id' INTEGER Not Null, 'groups_id' INTEGER, 'subgroupname' TEXT)")
        ObjConnect.Exec(" Create TABLE points( 'id' INTEGER Not Null, 'subgroups_id' INTEGER Not Null, 'title' TEXT, 'description' TEXT, 'groups_id' INTEGER Not Null, 'catalogs_id' INTEGER Not Null)")
        
        ObjConnect.Close()
        
        ' TBL = ObjConnect.Tables.Add("catalogs")
        '     TBL.Fields.Add("id", db.Integer)
        '     TBL.Fields.Add("catalogname", db.String, 0)
        '     TBL.PrimaryKey = ["id"]
        ' TBL.Update()
        
    
End


Public Sub _new()

End

Public Sub Form_Open()

    
    
    If Not Exist(User.Home & "/.Points/DB/Points") Then
        
        CreateDatabase()
        
    Endif
    If Not Exist(User.Home & "/.Points/DB/AttachFiles") Then
        Print "AttachFiles Directory NOT EXIST; Creating ..."
        Mkdir User.Home & "/.Points/DB/AttachFiles"
    Endif
    
End

Public Sub Form_Show()

    Me.Center
    Me.Maximized = True

End

Public Sub MnuExit_Click()

    Me.Close()

End

Public Sub MnuAddSet_Click()

    FrmAddSet.ShowDialog()

End

Public Sub MnuAddGroup_Click()

    FrmAddGroup.ShowDialog()

End

Public Sub MnuAddSubgroup_Click()

    FrmAddSubgroup.ShowDialog()

End

Public Sub MnuAddPoints_Click()

    FrmAddPoint.ShowDialog()

End

Public Sub Menu6_Click()

    FrmShowPoints.ShowDialog()

End

Public Sub Menu2_Click()

    FrmEditCatalogs.ShowDialog()

End

Public Sub Menu3_Click()

    FrmEditGroups.ShowDialog()

End

Public Sub Menu4_Click()

    FrmEditSubGroups.ShowDialog()

End

Public Sub MnuEditPoints_Click()

    FrmEditPoints.ShowDialog()

End

Public Sub MnuAbout_Click()

    FrmAbout.ShowPopup()

End
