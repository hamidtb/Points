' Gambas class file

' Gambas class file

Public CatalogID As New Integer[]

Public MC As New MainClass
Public ObjRes As Result

Function Refresh()
    Dim i As Integer
    
    Cmbcatalog.Clear()
    CatalogID.Clear()
    
    ObjRes = mc.CConnection().Exec("select id,catalogname from catalogs")
    For i = 1 To ObjRes.Count
        Cmbcatalog.Add(ObjRes!catalogname)
        CatalogID.Add(ObjRes!id)
        ObjRes.MoveNext
    Next
    
    If Cmbcatalog.Count = 0 Then
        Panel1.Enabled = False
        BtnEdit.Enabled = False
        BtnDel.Enabled = False
        TxtCatalog.Text = ""
    Else
        TxtCatalog.Text = Cmbcatalog.Text
        Panel1.Enabled = True
        BtnEdit.Enabled = True
        BtnDel.Enabled = True
    Endif  
    
End


Public Sub Form_Open()
    
    Me.Center()
    
    Refresh()

End

Public Sub BtnExit_Click()

    Me.Close()

End


Public Sub Cmbcatalog_Click()

    TxtCatalog.Text = Cmbcatalog.Text

End

Public Sub BtnEdit_Click()

    mc.CConnection().Exec("update catalogs set catalogname='" & TxtCatalog.Text & "' where id=" & CatalogID[Cmbcatalog.Index])
    Refresh()
End

Public Sub BtnDel_Click()
    If Message.Question("ایا مظمئن هستید", "بلی", "خیر") = 1 Then
        'Message("gfhgfh")
        mc.CConnection().Exec("delete from catalogs where id=" & CatalogID[Cmbcatalog.Index])
        Refresh()    
    Endif

End
